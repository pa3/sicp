(define (factorial n)
  (if (= n 1) 1 (* n (factorial (- n 1)))))

;;
;;
;;               +------------------------------------------------------+
;;               |                                                      |
;;               +----^-------------------^------------------------^----+
;; (factorial 6)      |                   |                        |
;;               +---------+         +---------+              +---------+
;;               |n: 6     |         |n: 5     |              |n: 1     |
;;         E1+--->         |   E2+--->         |  ...   E6+--->         |
;;               |         |         |         |              |         |
;;               +---------+         +---------+              +---------+
;;
;;              (if (= n 1)         (if (= n 1)              (if (= n 1)
;;                  1                   1                        1
;;                  (* n ... ))         (* n ... ))              (* n ... ))
;;

(define (factorial n) (fact-iter 1 1 n))
(define (fact-iter product counter max-count)
  (if (> counter max-count)
      product
      (fact-iter (* counter product)
                 (+ counter 1)
                 max-count)))

;;
;;               +-----------------------------------------------------
;;               |                                                      ...
;;               +----^-------------------^-----------------------^----
;; (factorial 6)      |                   |                       |
;;               +---------+         +------------+         +------------+
;;               |n: 6     |         |product: 1  |         |product: 1  |
;;         E1+--->         |   E2+--->counter: 1  |   E3+--->counter: 2  |
;;               |         |         |max-count: 6|         |max-count: 6|
;;               +---------+         +------------+         +------------+
;;
;;            (fact-iter 1 1 n)      (if (> counter         (if (> counter
;;                                          max-count)             max-count)
;;                                     ...                    ...
;;                                   )                      )
;;
;;                     -------------------------------------------+
;;             ...                                                |
;;                     ------------^-----------------------^------+
;;                                 |                       |
;;                            +------------+         +------------+
;;                            |product: 120|         |product: 720|
;;                      E6+--->counter: 6  |   E7+--->counter: 7  |
;;                            |max-count: 6|         |max-count: 6|
;;                            +------------+         +------------+
;;
;;                            (if (> counter         (if (> counter
;;                                   max-count)             max-count)
;;                              ...                    ...
;;                            )                      )
